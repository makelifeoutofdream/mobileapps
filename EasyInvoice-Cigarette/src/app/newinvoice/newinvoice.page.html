<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button menu="mainmenu"> 

      </ion-menu-button>
    </ion-buttons> 
   
    <ion-title>New Invoice</ion-title>
  </ion-toolbar>
</ion-header>
<ion-content>
  <div>
    <div class="row"></div>
   
    <ion-select style="margin-top: 2%;height: 30px;margin-right: 4%;" (ionChange)="populateCustomerProducts()" [(ngModel)]="invoice.customer" placeholder="Select Customer">
        <ion-select-option *ngFor="let cus of customerList" [value]="cus">{{cus.name}}</ion-select-option>
    </ion-select>
<!--<ion-item>
  <ion-label>Product</ion-label>
  <ionic-selectable style="height: 30px;"
    
    [(ngModel)]="product"
    [items]="products"
    itemValueField="name"
    itemTextField="name"
    [canSearch]="true"
    (onChange)="productSelected($event)"
    [isMultiple]="true"
    
    >
  </ionic-selectable>
</ion-item>  -->
    <div id="content" >
      <table *ngIf="showTable" border="none" style="width: 94%;margin-left: 2%;margin-right: 5%;margin-top: 2%; color: black;background-color: aliceblue; text-align: center;">
        <tr style="border: none; color: white; background-color: lightslategray;">
          <td style="width: 40%;text-align: left;">
            Item
          </td>
          <td style="text-align: left;">
            Price
          </td>
          <td style="text-align: left;">
            A.Qty
          </td>
          <td style="text-align: left;">
            Qty
          </td>
          
          <td style="text-align: left;">
            Amount
          </td>
        </tr>
        <tr *ngFor= "let item of products" style="border: none;">
          <td style="text-align: left;"><ion-input  disabled [(ngModel)]="item.name" ></ion-input></td>
          <td style="text-align: right;"><ion-input disabled (ionChange)="calculateInvoiceTotal(item)" type="number" [(ngModel)]="item.unitPrice" ></ion-input></td>
          <td style="text-align: right;"><ion-input disabled type="number" [(ngModel)]="item.displayBalanceQuantity"  (keypress)="numericOnly($event)"></ion-input></td>
          <td style="text-align: right;"><ion-input (ionChange)="calculateInvoiceTotal(item)" type="number" [(ngModel)]="item.quantity"  (keypress)="numericOnly($event)"></ion-input></td>
          <td style="text-align: right;"><ion-input disabled type="number" [(ngModel)]="item.unitPrice*item.quantity" ></ion-input></td>
        </tr>
      </table>
    </div>
  
    <ion-grid>
      <ion-row>
        <ion-item style="width: 100%;">
        <ion-col size="6">
          <ion-label >Apply VAT</ion-label>
        </ion-col>
        <ion-col size="6">
          <ion-checkbox color="primary" [(ngModel)]="applyVat" (ionChange)="calculateInvoiceTotal()" ></ion-checkbox>
        </ion-col>
      </ion-item>
      </ion-row>
        
      <ion-row>
    <ion-item style="width: 100%;"> 
          <ion-col size="6">
            <ion-label >Total</ion-label>
          </ion-col>
          <ion-col size="6" *ngIf="applyVat==true">
            <ion-label style="float: right;">{{(invoice.total-invoice.tax) | number : '1.2-2'}}</ion-label>
          </ion-col>
          <ion-col size="6" *ngIf="applyVat==false">
            <ion-label style="float: right;">{{invoice.total |    number : '1.2-2'}}</ion-label>
          </ion-col>
        </ion-item>
      </ion-row>  
      <ion-row>
        <ion-item style="width: 100%;">
        <ion-col size="6">
          <ion-label >Tax</ion-label>
        </ion-col>
        <ion-col size="6" *ngIf="applyVat==true">
          <ion-label style="float: right;">{{(invoice.tax | number : '1.2-2')}}</ion-label>
        </ion-col>
        <ion-col size="6" *ngIf="applyVat==false">
          <ion-label style="float: right;">{{(0 | number : '1.2-2')}}</ion-label>
        </ion-col>
      </ion-item>
    </ion-row>  
        



    <ion-row>
      <ion-item style="width: 100%;">
      <ion-col size="6">
        <ion-label >Gross Total(Incl. Tax)               </ion-label>
      </ion-col>
      <ion-col size="6">
        <ion-label style="float: right;">{{invoice.total | number : '1.2-2'}}</ion-label>
      </ion-col>
    </ion-item>
    </ion-row>

        
        
        <ion-row>
        <ion-item style="width: 100%;"> 
          <ion-col size="6">
            <ion-label text-wrap>Balance Amount(Incl. current invoice)</ion-label>
          </ion-col>
          <ion-col size="6">
            <ion-label style="float: right;">{{invoice.balanceAmount | number : '1.2-2'}}</ion-label>
          </ion-col>
        </ion-item>
        </ion-row>

        <ion-row>
          <ion-col size="12">
            <ion-item style="margin-left: 0px; padding-left: 0px;" >
              <ion-label style="margin-left: 0px;">Amount Paid</ion-label>
              <ion-input class="ion-text-right" type="number" [(ngModel)]="invoice.amountPaid" (ionChange)="calculateInvoiceTotal()"></ion-input>
            </ion-item>
          </ion-col>
        </ion-row>
        
        <!-- <ion-row>
          <ion-col size="6">
            <ion-label color="primary">Invoice Number</ion-label>
          </ion-col>
          <ion-col size="6">
            <ion-label >{{invoice.invoiceNumber}}</ion-label>
          </ion-col>
        </ion-row>   -->
      
    </ion-grid>
    <div style="display: none;">
      <ion-datetime value="invoice.invoiceDate" ></ion-datetime>
    </div>
  </div>
</ion-content>
<ion-footer>
  <ion-row style="float:right">
    <ion-col >
    <ion-button  color="primary" (click)="submitBill()">
      <ion-icon name="checkmark"></ion-icon>
     
      
    </ion-button>
    <ion-button color="primary" (click)="printBill()">
      <ion-icon name="print"></ion-icon>
    </ion-button>
  </ion-col>
  </ion-row>

</ion-footer>