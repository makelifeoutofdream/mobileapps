{"version":3,"sources":["webpack:///src/app/report/report.module.ts","webpack:///src/app/report/report-routing.module.ts","webpack:///src/app/report/report.page.scss","webpack:///src/app/report/report.page.html","webpack:///src/app/report/report.page.ts"],"names":["ReportPageModule","imports","declarations","routes","path","component","ReportPageRoutingModule","forChild","exports","ReportPage","dbService","toastService","printService","navCtrl","dataService","customerList","navigateForward","getAllInvoices","then","data","invoiceList","filterInvoices","reason","presentToast","console","log","getAllCustomers","header","push","startDate","endDate","getProfile","profile","start","Date","setHours","setMinutes","setSeconds","end","undefined","getFullYear","getMonth","getDate","selectedCustomer","filterInvoiceList","filter","inv","customer","id","invoiceDate","date","getHours","getMinutes","getSeconds","getTime","invoices","length","map","itm","tax","reduce","acc","nxt","total","invoiceDataList","Array","invoiceItems","invoiceData","InvoiceNumber","invoiceNumber","InvoiceDate","Customer","name","Item","UnitPrice","unitPrice","Quantity","quantity","Tax","Total","exportToExcel","invoice","navigationExtras","queryParams","navigateRoot","encoder","grossTax","totalTax","sum","grossTotal","today","datetime","result","initialize","bold","raw","align","line","companyName","newline","vatNumber","crNumber","vat","encode","sendToBluetoothPrinter","selectedPrinter","getFormatedContent","selector","template"],"mappings":"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","file":"report-report-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ReportPageRoutingModule } from './report-routing.module';\n\nimport { ReportPage } from './report.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ReportPageRoutingModule\n  ],\n  declarations: [ReportPage]\n})\nexport class ReportPageModule {}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ReportPage } from './report.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ReportPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ReportPageRoutingModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJyZXBvcnQucGFnZS5zY3NzIn0= */\";","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>Report</ion-title>\\n    <ion-buttons slot=\\\"start\\\">\\n        <ion-menu-button menu=\\\"mainmenu\\\"> \\n\\n        </ion-menu-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n<ion-content>\\n  <ion-row>\\n    <ion-item style=\\\"width: 95%;\\\" >\\n      <ion-col size=\\\"12\\\">\\n      <ion-select style=\\\"margin-top: 2%;height: 30px;margin-right: 4%; width: 95%;  max-width: 95% !important;\\\"  [(ngModel)]=\\\"selectedCustomer\\\" placeholder=\\\"Customer\\\">\\n        <ion-select-option style=\\\"width: 95%;\\\" *ngFor=\\\"let cus of customerList\\\" [value]=\\\"cus\\\">{{cus.name}}</ion-select-option>\\n      </ion-select>\\n    </ion-col>\\n    </ion-item>\\n  </ion-row>\\n  <ion-row>\\n    \\n    <ion-col size=\\\"4\\\" >\\n      <ion-item>\\n        <ion-datetime displayFormat=\\\"MMM DD YYYY\\\" [(ngModel)]=\\\"startDate\\\" placeholder=\\\"Start Date\\\"></ion-datetime>\\n      </ion-item>\\n    </ion-col>\\n\\n    <ion-col size=\\\"4\\\">\\n      <ion-item>\\n        <ion-datetime displayFormat=\\\"MMM DD YYYY\\\" [(ngModel)]=\\\"endDate\\\" placeholder=\\\"End Date\\\"></ion-datetime>\\n      </ion-item>\\n    </ion-col>\\n    <ion-col  size=\\\"4\\\" style=\\\"text-align: right;\\\">\\n      <ion-button style=\\\"padding-right: 5%;float: right;\\\" (click)=\\\"filterInvoices()\\\">\\n        <ion-icon name=\\\"search-outline\\\"></ion-icon>\\n      </ion-button>\\n    </ion-col>\\n  </ion-row>\\n  <ion-row style=\\\"float:right\\\">\\n    \\n  </ion-row>\\n  <ion-item-divider></ion-item-divider>\\n  \\n  <ion-list>\\n    <ion-list-header>\\n      <ion-col size=\\\"4\\\">Date</ion-col>\\n      <ion-col size=\\\"4\\\" style=\\\"text-align: center;\\\">Customer</ion-col>\\n      <ion-col style=\\\"text-align: right;padding-right: 5%;\\\" size=\\\"4\\\">Total</ion-col>\\n    </ion-list-header>\\n    <ion-item *ngFor= \\\"let inv of filterInvoiceList\\\" (click)=\\\"viewInvoice(inv)\\\">\\n      \\n        \\n        \\n          <ion-col size=\\\"4\\\">{{inv.invoiceDate | date : short}}</ion-col>\\n          <ion-col size=\\\"4\\\" style=\\\"text-align: center;\\\">{{inv.customer.name}}</ion-col>\\n          <ion-col style=\\\"text-align: right;\\\" size=\\\"4\\\">{{inv.total}}</ion-col>\\n       \\n     \\n    </ion-item>\\n  </ion-list>    \\n\\n</ion-content>\\n<ion-content  style=\\\"max-height: 5%;\\\" slot=\\\"fixed\\\">\\n  <div style=\\\" float:right;padding-right: 5%;\\\">\\n    <ion-label>Gross Total : {{sum(filterInvoiceList) | number : '1.2'}} </ion-label>\\n  </div>\\n\\n</ion-content>\\n<ion-footer>\\n  \\n    \\n      <ion-row style=\\\"float: right;\\\">\\n        <ion-col style=\\\"float: right;\\\">\\n          <ion-button ion-button  color=\\\"primary\\\" (click)=\\\"download()\\\">\\n            <ion-icon name=\\\"mail\\\"></ion-icon>\\n          </ion-button>\\n        </ion-col>\\n        <ion-col>\\n          <ion-button color=\\\"primary\\\" (click)=\\\"printBill()\\\">\\n            <ion-icon name=\\\"print\\\"></ion-icon>\\n          </ion-button>\\n        </ion-col>\\n      </ion-row>\\n        \\n    \\n  \\n  \\n</ion-footer>\";","import { Component, OnInit } from '@angular/core';\nimport { NavigationExtras } from '@angular/router';\nimport { NavController } from '@ionic/angular';\nimport { stat } from 'fs';\nimport { start } from 'repl';\nimport { filter } from 'rxjs/operators';\nimport { DataService } from '../data.service';\nimport { Customer } from '../services/customer';\nimport { DbService } from '../services/db.service';\nimport { Inventory } from '../services/inventory';\nimport { Invoice } from '../services/invoice';\nimport { ToastserviceService } from '../services/toastservice.service';\nimport EscPosEncoder from 'esc-pos-encoder-ionic';\nimport { Profile } from '../services/profile';\nimport {sprintf} from \"sprintf-js\";\nimport { PrintService } from '../services/print.service';\n@Component({\n  selector: 'app-report',\n  templateUrl: './report.page.html',\n  styleUrls: ['./report.page.scss'],\n})\nexport class ReportPage implements OnInit {\n  selectedCustomer : Customer;\n  startDate : Date;\n  endDate :Date;\n  invoiceList : Invoice [] ;\n  filterInvoiceList : Invoice [];\n  customerList : Customer [];\n  header : string [];\n  private profile : Profile;\n  constructor(public dbService : DbService,public toastService : ToastserviceService,private printService : PrintService,\n    public navCtrl:NavController,private dataService : DataService) { }\n\n  ngOnInit() {\n    this.customerList=[];\n  }\n\n  addNewInvoice(){\n    \n    this.navCtrl.navigateForward('newinvoice');\n  }\n\n  getAllInvoices(){\n    this.dbService.getAllInvoices().then(data=>{\n      this.invoiceList=data ;\n      this.filterInvoices();\n    }).catch(reason=>{\n      this.toastService.presentToast(\"Failed to fetch invoices\");\n      console.log(reason);\n    })\n  }\n  getAllCustomers(){\n    this.dbService.getAllCustomers().then(data=>this.customerList=data);\n  }\n  ionViewWillEnter(){\n    this.header=[];\n    this.header.push('Inv No');\n    this.header.push('Customer');\n    this.header.push('Total');\n    this.startDate=null;\n    this.endDate=null;\n    this.getAllInvoices();\n    this.getAllCustomers();\n    this.dbService.getProfile().then(data=>{\n      this.profile=data;\n    });\n    \n  }\n\n  \n  filterInvoices(){\n    var start=new Date(this.startDate);\n    start.setHours(0);\n    start.setMinutes(0);\n    start.setSeconds(0);\n    var end=new Date(this.endDate);\n    end.setHours(23);\n    end.setMinutes(23);\n    end.setSeconds(23);\n    if(this.startDate!=null && this.startDate!=undefined){\n      \n      start=new Date(start.getFullYear(),start.getMonth(),start.getDate());\n    }\n    if(this.endDate!=null && this.endDate!=undefined){\n      end=new Date(end.getFullYear(),end.getMonth(),end.getDate())\n    }\n    \n    \n    if(this.selectedCustomer!=null && this.selectedCustomer!=undefined && (this.startDate==null || this.startDate==undefined) && (this.endDate==null || this.endDate==undefined)){\n      this.filterInvoiceList= this.invoiceList.filter(inv=>inv.customer.id==this.selectedCustomer.id);\n    }else if(this.selectedCustomer!=null && this.selectedCustomer!=undefined && this.startDate!=null && this.startDate!=undefined && (this.endDate==null || this.endDate==undefined)){\n      this.filterInvoiceList= this.invoiceList.filter(inv=>inv.customer.id==this.selectedCustomer.id && new Date(inv.invoiceDate)>=start);\n    }else if(this.selectedCustomer!=null && this.selectedCustomer!=undefined && this.startDate!=null && this.startDate!=undefined &&  this.endDate!=null && this.endDate!=undefined){\n      this.filterInvoiceList= this.invoiceList.filter(inv=>{\n        var date=new Date(inv.invoiceDate);\n        date.setHours(inv.invoiceDate.getHours());\n        date.setMinutes(inv.invoiceDate.getMinutes());\n        date.setSeconds(inv.invoiceDate.getSeconds());\n       return  inv.customer.id==this.selectedCustomer.id && date.getTime()>=start.getTime() && date.getTime()<=end.getTime();\n      });\n    }else if((this.selectedCustomer==null || this.selectedCustomer==undefined) && this.startDate!=null && this.startDate!=undefined &&  this.endDate!=null && this.endDate!=undefined){\n      this.filterInvoiceList= this.invoiceList.filter(inv=>{\n        var date=new Date(inv.invoiceDate);\n        date.setHours(inv.invoiceDate.getHours());\n        date.setMinutes(inv.invoiceDate.getMinutes());\n        date.setSeconds(inv.invoiceDate.getSeconds());\n        return date.getTime()>=start.getTime() && date.getTime()<=end.getTime();\n      } )\n    }else if((this.selectedCustomer==null || this.selectedCustomer==undefined) && this.startDate!=null && this.startDate!=undefined &&  (this.endDate==null || this.endDate==undefined)){\n      this.filterInvoiceList= this.invoiceList.filter(inv=> new Date(inv.invoiceDate)>=start);\n    }else if((this.selectedCustomer==null || this.selectedCustomer==undefined) && (this.startDate==null || this.startDate==undefined) &&  this.endDate!=null && this.endDate!=undefined){\n      this.filterInvoiceList= this.invoiceList.filter(inv=> new Date(inv.invoiceDate)<=end );\n    }else{\n      this.filterInvoiceList=this.invoiceList;\n    }\n\n    \n  }\n\n  totalTax(invoices: any[]): number{\n    if(this.filterInvoiceList!=null && this.filterInvoiceList!=undefined && this.filterInvoiceList.length){\n      return this.filterInvoiceList.map(itm=>itm.tax).reduce((acc, nxt) => acc + nxt);\n    }\n  }\n\n  sum(invoices: any[]): number {\n    if(this.filterInvoiceList!=null && this.filterInvoiceList!=undefined && this.filterInvoiceList.length){\n      return this.filterInvoiceList.map(itm=>itm.total).reduce((acc, nxt) => acc + nxt);\n    }\n    \n }\n  download(){\n    let invoiceDataList=new Array();\n    for(let inv of this.invoiceList){\n      for(let itm of inv.invoiceItems){\n        let invoiceData ={InvoiceNumber : inv.invoiceNumber,InvoiceDate:inv.invoiceDate,Customer:inv.customer.name,Item:itm.name,UnitPrice:itm.unitPrice,Quantity:itm.quantity,Tax:inv.tax,Total:inv.total};\n        invoiceDataList.push(invoiceData);\n      }\n      \n    } \n     // this.dataService.downloadCcSV(this.invoiceList,'invoices.csv');\n     this.dataService.exportToExcel(invoiceDataList,'invoices.xlsx');\n     \n    \n  }\n\n  viewInvoice(invoice : Invoice){\n    let navigationExtras : NavigationExtras ={\n      queryParams : {invoice : invoice}\n};\nconsole.log(\"selected invoice\"+invoice.invoiceNumber);\nthis.navCtrl.navigateRoot('viewinvoice',navigationExtras);    \n}\n\n\ngetFormatedContent(){\n  const encoder = new EscPosEncoder();\n  \n  let grossTax=this.totalTax(this.filterInvoiceList);\n  let total=this.sum(this.filterInvoiceList);\n  let grossTotal=total-grossTax;\n  var today=new Date();\n  let datetime:string =today.getDate()+'-'+today.getMonth()+'-'+today.getFullYear()+' '+today.getHours()+':'+today.getMinutes()+':'+today.getSeconds();\n  let result=encoder.initialize().bold(true).raw([0x1B, 0x21, 0x20]).align('center').line(this.profile.companyName).bold(true).newline().\n  raw([0x1B, 0x21, 0x03]).align('left').bold(true).line('VAT # : '+ this.profile.vatNumber+','+'CR # : '+this.profile.crNumber).\n  align('left').bold(true).line('---------------------------------------------------------------').bold(true).\n  align('left').line('Print Generated At :'+datetime).\n  align('left').line('Date Range : '+this.startDate + 'To '+this.endDate).\n  align('left').bold(true).line('---------------------------------------------------------------').bold(true).\n  align('left').line('Gross Total(Excl.VAT) '+sprintf('%11.2f',grossTotal)).\n  align('left').line('Total VAT('+this.profile.vat+') '+sprintf('%11.2f',grossTax)).\n  align('left').line('Total '+sprintf('%11.2f',total)).\n  align('left').bold(true).line('---------------------------------------------------------------').bold(true).encode();\n\nreturn result;\n}\n\nprintBill(){\n  try{\n  this.printService.sendToBluetoothPrinter(this.profile.selectedPrinter,this.getFormatedContent());\n  \n }catch(reason){\n    this.toastService.presentToast(\"Print Failed\"+reason)\n  }\n  \n}\n\n\n}\n"]}