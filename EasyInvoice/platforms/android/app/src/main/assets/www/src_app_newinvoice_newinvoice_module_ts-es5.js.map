{"version":3,"sources":["webpack:///src/app/newinvoice/newinvoice-routing.module.ts","webpack:///src/app/newinvoice/newinvoice.module.ts","webpack:///src/app/newinvoice/newinvoice.page.ts","webpack:///src/app/services/invoice.ts","webpack:///src/app/validation.service.ts","webpack:///src/app/newinvoice/newinvoice.page.scss","webpack:///src/app/newinvoice/newinvoice.page.html"],"names":["routes","path","component","NewinvoicePage","NewinvoicePageRoutingModule","NgModule","imports","RouterModule","exports","NewinvoicePageModule","CommonModule","FormsModule","IonicModule","IonicSelectableModule","declarations","dbService","tostService","navCtrl","printService","validationService","invoice","id","invoiceNumber","invoiceDate","Date","invoiceDateString","customer","code","name","itemList","nameInArabic","contactPersonName","contactPersonNameInArabic","buildingNumber","street","streetInArabic","city","cityInArabic","district","districtInArabic","country","countryInArabic","pobox","postalCode","phoneNumber","mobile","email","vatNumber","crNumber","creditLimit","balance","invoiceItems","total","tax","applyVat","getProfile","then","data","profile","resetInvoiceForm","evt","product","unitPrice","billingUnitPrice","quantity","selected","purchaseUnitPrice","products","productsBackup","searchTerm","srcElement","value","filter","currentProduct","toLowerCase","indexOf","selectedProducts","Array","Invoice","incrementInvoiceNumber","getAllCustomers","customerList","undefined","console","log","inventory","inv","InvoiceItem","purchasePrice","push","itm","vat","setHours","createOrUpdateInvoice","getAllInventories","stocks","stockList","index","findIndex","i","saveAllInventories","res","presentToast","navigateRoot","reason","sendToBluetoothPrinter","selectedPrinter","numericOnly","DbService","ToastserviceService","NavController","PrintService","ValidationService","Component","selector","template","event","pattern","result","test","key","Injectable","providedIn"],"mappings":"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","file":"src_app_newinvoice_newinvoice_module_ts-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { NewinvoicePage } from './newinvoice.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: NewinvoicePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class NewinvoicePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { NewinvoicePageRoutingModule } from './newinvoice-routing.module';\n\nimport { NewinvoicePage } from './newinvoice.page';\nimport { IonicSelectableModule } from 'ionic-selectable';\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    NewinvoicePageRoutingModule,\n    IonicSelectableModule\n  ],\n  declarations: [NewinvoicePage]\n})\nexport class NewinvoicePageModule {}\n","import { isNgTemplate } from '@angular/compiler';\nimport { Component, IterableDiffers, OnInit } from '@angular/core';\nimport { NavController } from '@ionic/angular';\nimport { threadId } from 'worker_threads';\nimport { Customer } from '../services/customer';\nimport { DbService } from '../services/db.service';\nimport { Inventory } from '../services/inventory';\nimport { Invoice } from '../services/invoice';\nimport { InvoiceItem } from '../services/invoiceitem';\nimport { PrintService } from '../services/print.service';\nimport { Profile } from '../services/profile';\nimport { ToastserviceService } from '../services/toastservice.service';\nimport { ValidationService } from '../validation.service';\n\n@Component({\n  selector: 'app-newinvoice',\n  templateUrl: './newinvoice.page.html',\n  styleUrls: ['./newinvoice.page.scss']\n})\nexport class NewinvoicePage implements OnInit {\n  private invoice : Invoice;\n  private product : InvoiceItem;\n  private customerList:Customer[];\n  private products:InvoiceItem[];\n  private productsBackup:InvoiceItem[];\n  private selectedProducts:InvoiceItem[];\n  private profile : Profile;\n  private applyVat : boolean;\n  constructor(public dbService:DbService,public tostService:ToastserviceService,public navCtrl:NavController,\n    public printService : PrintService,private validationService :ValidationService) { }\n\n  ngOnInit() {\n    this.invoice={id:null, invoiceNumber : \"\",invoiceDate: new Date() ,invoiceDateString : \"\",\n    customer :  {id:null,code:null,name : \"\" ,itemList : null,nameInArabic : \"\",contactPersonName: \"\",contactPersonNameInArabic:\"\",\n    buildingNumber:\"\",street:\"\",streetInArabic:\"\",city:\"\",cityInArabic:\"\",district:\"\",districtInArabic:\"\",country:\"\",countryInArabic:\"\",\n    pobox:\"\",postalCode:\"\",phoneNumber:\"\",mobile:\"\",email:\"\",vatNumber:\"\",crNumber:\"\",creditLimit:null,balance:null},\n    invoiceItems : [],\n  total:null,tax:null} \n}\n\n\nionViewWillEnter(){\n  this.applyVat=true;\n  this.dbService.getProfile().then(data=>{\n    this.profile=data;\n  });\n  this.resetInvoiceForm();\n}\n\n\nasync filterProducts(evt) {\n  this.product={id: null, name: \"\",unitPrice : null,billingUnitPrice:null,quantity:null,selected:null,purchaseUnitPrice:null};\n  this.products=this.productsBackup;\n  const searchTerm = evt.srcElement.value;\n\n  if (!searchTerm) {\n    return;\n  }\n\n  this.products = this.products.filter(currentProduct => {\n    if (currentProduct.name && searchTerm) {\n      return (currentProduct.name.toLowerCase().indexOf(searchTerm.toLowerCase()) > -1);\n    }\n  });\n}\n\nproductSelected(evt){\n  this.selectedProducts=evt.value;\n  this.invoice.invoiceItems=this.selectedProducts;  \n}\n\nresetInvoiceForm(){\n  this.productsBackup=new Array();\n  this.products=new Array();\n  \n  this.invoice=new Invoice();\n  this.dbService.incrementInvoiceNumber().then(data=>{\n    this.invoice.invoiceNumber=data;\n  });\n\n  this.invoice.invoiceDate=new Date();\n  this.invoice.invoiceItems=new Array();\n  this.selectedProducts=new Array();\n  //this.dbService.getInvoiceNumber().then(data=>{\n    //this.invoice.invoiceNumber=data;\n  //});\n  this.dbService.getAllCustomers().then(data=>this.customerList=data);\n}\n  \npopulateCustomerProducts(){\n  if(this.invoice.customer!=null && this.invoice.customer!=undefined && this.invoice.customer.itemList!=null && this.invoice.customer.itemList!=undefined){\n    console.log(\"populateCustomerProducts\");\n    let inventory ;\n    for(let inv of this.invoice.customer.itemList){\n      inventory={id: inv.id, name : inv.name,unitPrice : inv.unitPrice,billingUnitPrice:null,quantity:null,InvoiceItem:[],purchasePrice:inv.purchasePrice};\n        this.products.push(inventory);\n        this.productsBackup.push(inventory);\n    }\n  }\n  \n}\n\ncalculateInvoiceTotal(evt){\n  this.invoice.total=0;\n  if(undefined==this.invoice.total || null==this.invoice.total){\n    this.invoice.total=0;\n  }\n  for(let itm of this.invoice.invoiceItems){\n    this.invoice.total=this.invoice.total+ (itm.unitPrice*itm.quantity);\n  }\n  //apply vat\n  if(this.applyVat){\n    if(this.profile!=null && this.profile!=undefined && this.profile.vat!=null && this.profile.vat!=undefined){\n      this.invoice.tax=(this.profile.vat*this.invoice.total)/100;\n      this.invoice.total=this.invoice.total+this.invoice.tax;\n    }\n  \n  }\n  \n  \n}\n\nsubmitBill(){\n  this.invoice.invoiceDate.setHours(0,0,0,0);\n  this.dbService.createOrUpdateInvoice(this.invoice).then(data=>{\n    this.dbService.getAllInventories().then(stocks=>{\n      let stockList=stocks;\n      for(let itm of this.invoice.invoiceItems){\n        var index = stockList.findIndex(i => i.id == itm.id);\n        stockList[index].quantity=stockList[index].quantity-itm.quantity;\n      }\n      this.dbService.saveAllInventories(stockList).then(res=>{\n        this.tostService.presentToast(\"Bill submitted successfully\");\n        this.navCtrl.navigateRoot('invoice');\n      })\n    });\n  }).catch(reason=>{\n    this.tostService.presentToast(\"Failed to submit bill\");\n    console.log(reason);\n  })\n}\n\nprintBill(){\n  let data='---------------------RECEIPT-----------------------\\n\\n\\nDate :'+this.invoice.invoiceDate+'\\nInvoice Number :'+this.invoice.invoiceNumber+'\\nCustomer:'+this.invoice.customer+'/n/n';\n  for(let itm of this.invoice.invoiceItems){\n    data=data+'Item Name :'+itm.name+'  Price :'+itm.unitPrice+'  Quantity :'+itm.quantity;\n  }\n  data=data+'-----------------------------------------------------------------------';\n  data=data+'\\n Vat Applied :'+this.invoice.customer.vatNumber;\n  data=data+'\\n Total :'+this.invoice.total;\n  this.printService.sendToBluetoothPrinter(this.printService.selectedPrinter,data);\n}\n\nnumericOnly(evt){\n  return this.validationService.numericOnly(evt);\n}\n}\n","import { InvoiceItem } from \"./invoiceitem\";\nimport {Customer} from './customer';\nexport class Invoice{\n    id : number;\n    invoiceNumber : string;\n    invoiceItems : InvoiceItem [];\n    invoiceDate : Date ;\n    customer : Customer;\n    total : number;\n    tax : number;\n    invoiceDateString : string;\n}","import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ValidationService {\n\n  constructor() { }\n\n\nnumericOnly(event): boolean {\n  let pattern = /^([0-9])$/;\n  let result = pattern.test(event.key);\n  return result;\n}\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJuZXdpbnZvaWNlLnBhZ2Uuc2NzcyJ9 */\";","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>New Invoice</ion-title>\\n    <ion-buttons slot=\\\"start\\\">\\n        <ion-menu-button menu=\\\"mainmenu\\\"> \\n\\n        </ion-menu-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n<ion-content>\\n  <div class=\\\"row\\\"></div>\\n   \\n<ion-select style=\\\"margin-top: 2%;height: 30px;margin-right: 4%;\\\" (ionChange)=\\\"populateCustomerProducts()\\\" [(ngModel)]=\\\"invoice.customer\\\" placeholder=\\\"Select Customer\\\">\\n  <ion-select-option *ngFor=\\\"let cus of customerList\\\" [value]=\\\"cus\\\">{{cus.name}}</ion-select-option>\\n</ion-select>\\n<ion-item>\\n  <ion-label>Product</ion-label>\\n  <ionic-selectable style=\\\"height: 30px;\\\"\\n    \\n    [(ngModel)]=\\\"product\\\"\\n    [items]=\\\"products\\\"\\n    itemValueField=\\\"name\\\"\\n    itemTextField=\\\"name\\\"\\n    [canSearch]=\\\"true\\\"\\n    (onChange)=\\\"productSelected($event)\\\"\\n    [isMultiple]=\\\"true\\\">\\n  </ionic-selectable>\\n</ion-item> \\n<table border=\\\"5\\\" style=\\\"width: 94%;margin-left: 2%;margin-right: 5%;margin-top: 2%;\\\">\\n  <tr>\\n    <td>\\n      Item\\n    </td>\\n    <td>\\n      Price\\n    </td>\\n    <td>\\n      Purchase Price\\n    </td>\\n    <td>\\n      Quantity\\n    </td>\\n  </tr>\\n  <tr *ngFor= \\\"let item of invoice.invoiceItems\\\" >\\n    <td><ion-input  disabled [(ngModel)]=\\\"item.name\\\" ></ion-input></td>\\n    <td><ion-input (ionChange)=\\\"calculateInvoiceTotal()\\\" type=\\\"number\\\" [(ngModel)]=\\\"item.unitPrice\\\" ></ion-input></td>\\n    <td><ion-input (ionChange)=\\\"calculateInvoiceTotal()\\\" type=\\\"number\\\" [(ngModel)]=\\\"item.purchasePrice\\\" ></ion-input></td>\\n    <td><ion-input (ionChange)=\\\"calculateInvoiceTotal()\\\" type=\\\"number\\\" [(ngModel)]=\\\"item.quantity\\\"  (keypress)=\\\"numericOnly($event)\\\"></ion-input></td>\\n  </tr>\\n</table>\\n\\n<ion-grid>\\n    <ion-row>\\n      <ion-col size=\\\"6\\\">\\n        <ion-label color=\\\"primary\\\">Amount To Be Paid</ion-label>\\n      </ion-col>\\n      <ion-col size=\\\"6\\\">\\n        <ion-label >{{invoice.total}}</ion-label>\\n      </ion-col>\\n    </ion-row>\\n    <ion-row>\\n      <ion-col size=\\\"3\\\">\\n        <ion-label color=\\\"primary\\\">Apply VAT</ion-label>\\n      </ion-col>\\n      <ion-col size=\\\"6\\\">\\n        <ion-checkbox color=\\\"primary\\\" [(ngModel)]=\\\"applyVat\\\" (ionChange)=\\\"calculateInvoiceTotal()\\\" ></ion-checkbox>\\n      </ion-col>\\n      \\n    </ion-row>  \\n    <!-- <ion-row>\\n      <ion-col size=\\\"6\\\">\\n        <ion-label color=\\\"primary\\\">Invoice Number</ion-label>\\n      </ion-col>\\n      <ion-col size=\\\"6\\\">\\n        <ion-label >{{invoice.invoiceNumber}}</ion-label>\\n      </ion-col>\\n    </ion-row>   -->\\n  \\n  </ion-grid>\\n    <ion-grid>\\n      <ion-row> \\n        <ion-col size=\\\"3\\\">\\n          <ion-button color=\\\"primary\\\" (click)=\\\"submitBill()\\\">Submit</ion-button>\\n        </ion-col>\\n        \\n        <ion-col size=\\\"3\\\">\\n          <ion-button color=\\\"primary\\\" (click)=\\\"printBill()\\\">Print</ion-button>\\n        </ion-col>\\n\\n      </ion-row>\\n    </ion-grid>\\n</ion-content>\\n\";"]}