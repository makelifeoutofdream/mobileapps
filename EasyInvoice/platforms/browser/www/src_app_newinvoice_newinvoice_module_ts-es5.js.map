{"version":3,"sources":["webpack:///src/app/newinvoice/newinvoice-routing.module.ts","webpack:///src/app/newinvoice/newinvoice.module.ts","webpack:///src/app/newinvoice/newinvoice.page.ts","webpack:///src/app/services/invoice.ts","webpack:///src/app/newinvoice/newinvoice.page.scss","webpack:///src/app/newinvoice/newinvoice.page.html"],"names":["routes","path","component","NewinvoicePage","NewinvoicePageRoutingModule","NgModule","imports","RouterModule","exports","NewinvoicePageModule","CommonModule","FormsModule","IonicModule","declarations","dbService","tostService","navCtrl","printService","invoice","invoiceNumber","invoiceDate","Date","customer","contactPersonName","location","name","vat","itemList","invoiceItems","total","tax","resetInvoiceForm","inventory","Invoice","Array","getInvoiceNumber","then","data","getAllInventories","inv","unitPrice","billingUnitPrice","quantity","InvoiceItem","push","getAllCustomers","customerList","reason","console","log","presentToast","selectedItems","filter","l","selected","undefined","itm","createOrUpdateInvoice","incrementInvoiceNumber","sendToBluetoothPrinter","selectedPrinter","DbService","ToastserviceService","NavController","PrintService","Component","selector","template"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA,UAAMA,MAAM,GAAW,CACrB;AACEC,YAAI,EAAE,EADR;AAEEC,iBAAS,EAAE,8CAAAC;AAFb,OADqB,CAAvB;;UAWaC,4BAA2B;AAAA;AAAA,O;;AAA3BA,kCAA2B,uDAJvC,+CAAAC,QAAA,EAAS;AACRC,eAAO,EAAE,CAAC,6CAAAC,YAAA,UAAsBP,MAAtB,CAAD,CADD;AAERQ,eAAO,EAAE,CAAC,6CAAAD,YAAD;AAFD,OAAT,CAIuC,GAA3BH,4BAA2B,CAA3B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCGAK,qBAAoB;AAAA;AAAA,O;;AAApBA,2BAAoB,uDAThC,+CAAAJ,QAAA,EAAS;AACRC,eAAO,EAAE,CACP,6CAAAI,YADO,EAEP,4CAAAC,WAFO,EAGP,4CAAAC,WAHO,EAIP,wDAAAR,2BAJO,CADD;AAORS,oBAAY,EAAE,CAAC,8CAAAV,cAAD;AAPN,OAAT,CASgC,GAApBM,qBAAoB,CAApB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCFAN,eAAc;AAGzB,gCAAmBW,SAAnB,EAA8CC,WAA9C,EAAqFC,OAArF,EACSC,YADT,EACsC;AAAA;;AADnB,eAAAH,SAAA,GAAAA,SAAA;AAA2B,eAAAC,WAAA,GAAAA,WAAA;AAAuC,eAAAC,OAAA,GAAAA,OAAA;AAC5E,eAAAC,YAAA,GAAAA,YAAA;AAAgC;;AAJhB;AAAA;AAAA,iBAMzB,oBAAW;AACT,iBAAKC,OAAL,GAAa;AAACC,2BAAa,EAAG,EAAjB;AAAoBC,yBAAW,EAAE,IAAIC,IAAJ,EAAjC;AACbC,sBAAQ,EAAG;AAACC,iCAAiB,EAAG,EAArB;AAAwBC,wBAAQ,EAAI,EAApC;AAAuCC,oBAAI,EAAG,EAA9C;AAAiDC,mBAAG,EAAC,IAArD;AAA0DC,wBAAQ,EAAG;AAArE,eADE;AACyEC,0BAAY,EAAG,EADxF;AAEfC,mBAAK,EAAC,IAFS;AAEJC,iBAAG,EAAC;AAFA,aAAb;AAGH;AAV0B;AAAA;AAAA,iBAa3B,4BAAgB;AACd,iBAAKC,gBAAL;AACD;AAf0B;AAAA;AAAA,iBAiB3B,4BAAgB;AAAA;;AAEd,gBAAIC,SAAJ;AACA,iBAAKd,OAAL,GAAa,IAAI,+CAAAe,OAAJ,EAAb;AACA,iBAAKf,OAAL,CAAaE,WAAb,GAAyB,IAAIC,IAAJ,EAAzB;AACA,iBAAKH,OAAL,CAAaU,YAAb,GAA0B,IAAIM,KAAJ,EAA1B;AACA,iBAAKpB,SAAL,CAAeqB,gBAAf,GAAkCC,IAAlC,CAAuC,UAAAC,IAAI,EAAE;AAC3C,mBAAI,CAACnB,OAAL,CAAaC,aAAb,GAA2BkB,IAA3B;AACD,aAFD;AAGA,iBAAKvB,SAAL,CAAewB,iBAAf,GAAmCF,IAAnC,CAAwC,UAAAC,IAAI,EAAE;AAAA,yDAC7BA,IAD6B;AAAA;;AAAA;AAC5C,oEAAoB;AAAA,sBAAZE,GAAY;AAClBP,2BAAS,GAAC;AAACP,wBAAI,EAAGc,GAAG,CAACd,IAAZ;AAAiBe,6BAAS,EAAGD,GAAG,CAACC,SAAjC;AAA2CC,oCAAgB,EAAC,IAA5D;AAAiEC,4BAAQ,EAAC,IAA1E;AAA+EC,+BAAW,EAAC;AAA3F,mBAAV;;AACA,uBAAI,CAACzB,OAAL,CAAaU,YAAb,CAA0BgB,IAA1B,CAA+BZ,SAA/B;AACD;AAJ2C;AAAA;AAAA;AAAA;AAAA;;AAK5C,mBAAI,CAAClB,SAAL,CAAe+B,eAAf,GAAiCT,IAAjC,CAAsC,UAAAC,IAAI;AAAA,uBAAE,KAAI,CAACS,YAAL,GAAkBT,IAApB;AAAA,eAA1C;AACD,aAND,WAMS,UAAAU,MAAM,EAAE;AACfC,qBAAO,CAACC,GAAR,CAAYF,MAAZ;;AACA,mBAAI,CAAChC,WAAL,CAAiBmC,YAAjB,CAA8B,qCAA9B;AACD,aATD;AAUD;AApC0B;AAAA;AAAA,iBAsC3B,iCAAqB;AACnB,iBAAKhC,OAAL,CAAaW,KAAb,GAAmB,CAAnB;AACA,gBAAIsB,aAAa,GAAiB,KAAKjC,OAAL,CAAaU,YAAb,CAA0BwB,MAA1B,CAAiC,UAAAC,CAAC;AAAA,qBAAEA,CAAC,CAACC,QAAJ;AAAA,aAAlC,CAAlC;;AACA,gBAAGC,SAAS,IAAE,KAAKrC,OAAL,CAAaW,KAAxB,IAAiC,QAAM,KAAKX,OAAL,CAAaW,KAAvD,EAA6D;AAC3D,mBAAKX,OAAL,CAAaW,KAAb,GAAmB,CAAnB;AACD;;AALkB,wDAMJsB,aANI;AAAA;;AAAA;AAMnB,qEAA6B;AAAA,oBAArBK,GAAqB;AAC3B,qBAAKtC,OAAL,CAAaW,KAAb,GAAmB,KAAKX,OAAL,CAAaW,KAAb,GAAqB2B,GAAG,CAAChB,SAAJ,GAAcgB,GAAG,CAACd,QAA1D;AACD,eARkB,CASnB;;AATmB;AAAA;AAAA;AAAA;AAAA;;AAUnB,iBAAKxB,OAAL,CAAaY,GAAb,GAAkB,KAAKZ,OAAL,CAAaI,QAAb,CAAsBI,GAAtB,GAA0B,KAAKR,OAAL,CAAaW,KAAxC,GAA+C,GAAhE;AACA,iBAAKX,OAAL,CAAaW,KAAb,GAAmB,KAAKX,OAAL,CAAaW,KAAb,GAAmB,KAAKX,OAAL,CAAaY,GAAnD;AAED;AAnD0B;AAAA;AAAA,iBAqD3B,sBAAU;AAAA;;AACR,iBAAKhB,SAAL,CAAe2C,qBAAf,CAAqC,KAAKvC,OAA1C,EAAmDkB,IAAnD,CAAwD,UAAAC,IAAI,EAAE;AAC5D,oBAAI,CAACtB,WAAL,CAAiBmC,YAAjB,CAA8B,6BAA9B;;AACA,oBAAI,CAACpC,SAAL,CAAe4C,sBAAf,GAAwCtB,IAAxC,CAA6C,UAAAC,IAAI,EAAE;AACjD,sBAAI,CAACnB,OAAL,CAAaC,aAAb,GAA2BkB,IAA3B;AACD,eAFD;AAID,aAND,WAMS,UAAAU,MAAM,EAAE;AACf,oBAAI,CAAChC,WAAL,CAAiBmC,YAAjB,CAA8B,uBAA9B;;AACAF,qBAAO,CAACC,GAAR,CAAYF,MAAZ;AACD,aATD;AAUD;AAhE0B;AAAA;AAAA,iBAkE3B,qBAAS;AACP,gBAAIV,IAAI,GAAC,oEAAkE,KAAKnB,OAAL,CAAaE,WAA/E,GAA2F,oBAA3F,GAAgH,KAAKF,OAAL,CAAaC,aAA7H,GAA2I,aAA3I,GAAyJ,KAAKD,OAAL,CAAaI,QAAtK,GAA+K,MAAxL;;AADO,wDAEQ,KAAKJ,OAAL,CAAaU,YAFrB;AAAA;;AAAA;AAEP,qEAAyC;AAAA,oBAAjC4B,GAAiC;AACvCnB,oBAAI,GAACA,IAAI,GAAC,aAAL,GAAmBmB,GAAG,CAAC/B,IAAvB,GAA4B,WAA5B,GAAwC+B,GAAG,CAAChB,SAA5C,GAAsD,cAAtD,GAAqEgB,GAAG,CAACd,QAA9E;AACD;AAJM;AAAA;AAAA;AAAA;AAAA;;AAKPL,gBAAI,GAACA,IAAI,GAAC,yEAAV;AACAA,gBAAI,GAACA,IAAI,GAAC,kBAAL,GAAwB,KAAKnB,OAAL,CAAaI,QAAb,CAAsBI,GAAnD;AACAW,gBAAI,GAACA,IAAI,GAAC,YAAL,GAAkB,KAAKnB,OAAL,CAAaW,KAApC;AACA,iBAAKZ,YAAL,CAAkB0C,sBAAlB,CAAyC,KAAK1C,YAAL,CAAkB2C,eAA3D,EAA2EvB,IAA3E;AACD;AA3E0B;;AAAA;AAAA,S;;;;gBAZlB,kDAAAwB;;gBAKA,4DAAAC;;gBARA,4CAAAC;;gBAOA,qDAAAC;;;;AAQI7D,qBAAc,uDAL1B,+CAAA8D,SAAA,EAAU;AACTC,gBAAQ,EAAE,gBADD;AAETC,gBAAQ,EAAR,wEAFS;;AAAA,OAAV,CAK0B,GAAdhE,eAAc,CAAd;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCfA8B,Q;;;;;;;;;;;;;;;;;;ACFb;;;AAAA,uCAAe,qKAAf;;;;;;;;;;;;;;;ACAA;;;AAAA,uCAAe,krGAAf","file":"src_app_newinvoice_newinvoice_module_ts-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { NewinvoicePage } from './newinvoice.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: NewinvoicePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class NewinvoicePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { NewinvoicePageRoutingModule } from './newinvoice-routing.module';\n\nimport { NewinvoicePage } from './newinvoice.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    NewinvoicePageRoutingModule\n  ],\n  declarations: [NewinvoicePage]\n})\nexport class NewinvoicePageModule {}\n","import { isNgTemplate } from '@angular/compiler';\nimport { Component, IterableDiffers, OnInit } from '@angular/core';\nimport { NavController } from '@ionic/angular';\nimport { threadId } from 'worker_threads';\nimport { Customer } from '../services/customer';\nimport { DbService } from '../services/db.service';\nimport { Inventory } from '../services/inventory';\nimport { Invoice } from '../services/invoice';\nimport { InvoiceItem } from '../services/invoiceitem';\nimport { PrintService } from '../services/print.service';\nimport { ToastserviceService } from '../services/toastservice.service';\n\n@Component({\n  selector: 'app-newinvoice',\n  templateUrl: './newinvoice.page.html',\n  styleUrls: ['./newinvoice.page.scss'],\n})\nexport class NewinvoicePage implements OnInit {\n  private invoice : Invoice;\n  private customerList:Customer[];\n  constructor(public dbService:DbService,public tostService:ToastserviceService,public navCtrl:NavController,\n    public printService : PrintService) { }\n\n  ngOnInit() {\n    this.invoice={invoiceNumber : \"\",invoiceDate: new Date() ,\n    customer : {contactPersonName : \"\",location  : \"\",name : \"\",vat:null,itemList : null},invoiceItems : [],\n  total:null,tax:null} \n}\n\n\nionViewWillEnter(){\n  this.resetInvoiceForm();\n}\n\nresetInvoiceForm(){\n\n  let inventory ;\n  this.invoice=new Invoice();\n  this.invoice.invoiceDate=new Date();\n  this.invoice.invoiceItems=new Array();\n  this.dbService.getInvoiceNumber().then(data=>{\n    this.invoice.invoiceNumber=data;\n  });\n  this.dbService.getAllInventories().then(data=>{\n    for(let inv of data){\n      inventory={name : inv.name,unitPrice : inv.unitPrice,billingUnitPrice:null,quantity:null,InvoiceItem:[]};\n      this.invoice.invoiceItems.push(inventory);\n    }\n    this.dbService.getAllCustomers().then(data=>this.customerList=data);\n  }).catch(reason=>{\n    console.log(reason);\n    this.tostService.presentToast(\"Failed to fetch the inventory items\"); \n  })\n}\n  \ncalculateInvoiceTotal(){\n  this.invoice.total=0;\n  let selectedItems : InvoiceItem[]=this.invoice.invoiceItems.filter(l=>l.selected);\n  if(undefined==this.invoice.total || null==this.invoice.total){\n    this.invoice.total=0;\n  }\n  for(let itm of selectedItems){\n    this.invoice.total=this.invoice.total+ (itm.unitPrice*itm.quantity);\n  }\n  //apply vat\n  this.invoice.tax=(this.invoice.customer.vat*this.invoice.total)/100;\n  this.invoice.total=this.invoice.total+this.invoice.tax;\n  \n}\n\nsubmitBill(){\n  this.dbService.createOrUpdateInvoice(this.invoice).then(data=>{\n    this.tostService.presentToast(\"Bill submitted successfully\");\n    this.dbService.incrementInvoiceNumber().then(data=>{\n      this.invoice.invoiceNumber=data;\n    });\n\n  }).catch(reason=>{\n    this.tostService.presentToast(\"Failed to submit bill\");\n    console.log(reason);\n  })\n}\n\nprintBill(){\n  let data='---------------------RECEIPT-----------------------\\n\\n\\nDate :'+this.invoice.invoiceDate+'\\nInvoice Number :'+this.invoice.invoiceNumber+'\\nCustomer:'+this.invoice.customer+'/n/n';\n  for(let itm of this.invoice.invoiceItems){\n    data=data+'Item Name :'+itm.name+'  Price :'+itm.unitPrice+'  Quantity :'+itm.quantity;\n  }\n  data=data+'-----------------------------------------------------------------------';\n  data=data+'\\n Vat Applied :'+this.invoice.customer.vat;\n  data=data+'\\n Total :'+this.invoice.total;\n  this.printService.sendToBluetoothPrinter(this.printService.selectedPrinter,data);\n}\n}\n","import { InvoiceItem } from \"./invoiceitem\";\nimport {Customer} from './customer';\nexport class Invoice{\n    invoiceNumber : string;\n    invoiceItems : InvoiceItem [];\n    invoiceDate : Date ;\n    customer : Customer;\n    total : number;\n    tax : number;\n}","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJuZXdpbnZvaWNlLnBhZ2Uuc2NzcyJ9 */\";","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>New Invoice</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <div class=\\\"row\\\"></div>\\n    <ion-grid class=\\\"ion-margin-top\\\">\\n\\n      <ion-row>\\n        <ion-col size=\\\"6\\\" >  \\n              <ion-row >\\n                <ion-label style=\\\"margin-left: 18px;\\\" color=\\\"primary\\\" >Invoice Number</ion-label>\\n              </ion-row>\\n              <ion-row >\\n                <ion-label position=\\\"floating\\\" style=\\\"margin-left: 18px;\\\" >{{invoice.invoiceNumber}}</ion-label>\\n              </ion-row>\\n\\n            \\n            </ion-col>\\n            <ion-col size=\\\"6\\\">\\n              <ion-row>\\n                <ion-label color=\\\"primary\\\"  >Date Of Issue</ion-label>\\n              </ion-row>\\n              <ion-row>\\n                <ion-label position=\\\"floating\\\">{{invoice.invoiceDate|date : 'yyyy-MM-dd'}}</ion-label>\\n              </ion-row>\\n\\n            \\n          \\n          \\n        </ion-col>\\n      </ion-row>\\n      <ion-row style=\\\"margin-top: 7px;\\\">\\n        <ion-col>\\n          \\n            <ion-select [(ngModel)]=\\\"invoice.customer\\\" placeholder=\\\"Select Customer\\\">\\n              <ion-select-option *ngFor=\\\"let cus of customerList\\\" [value]=\\\"cus\\\">{{cus.name}}</ion-select-option>\\n          </ion-select>\\n          \\n        \\n      </ion-col>\\n      </ion-row>\\n</ion-grid>\\n<ion-item-divider></ion-item-divider>\\n <ion-list >\\n  <ion-item  *ngFor= \\\"let item of invoice.invoiceItems\\\">\\n    <ion-grid>\\n      <ion-row style=\\\"color : white ; background-color: blueviolet;\\\">\\n        <ion-col size=\\\"3\\\">Select</ion-col>\\n        <ion-col size=4>Item</ion-col>\\n        <ion-col size=2>Price</ion-col>\\n        <ion-col size=\\\"2\\\">Qty</ion-col>\\n      </ion-row>\\n    <ion-row style=\\\"background-color: aliceblue;\\\">\\n        <ion-col size=\\\"3\\\">\\n          <ion-checkbox [(ngModel)]=\\\"item.selected\\\"> </ion-checkbox>\\n        </ion-col>\\n      <ion-col size=4>\\n        <ion-input [(ngModel)]=\\\"item.name\\\" disabled></ion-input>\\n      </ion-col>\\n      <ion-col size=\\\"2\\\">\\n        <ion-input [(ngModel)]=\\\"item.unitPrice\\\" ></ion-input>\\n      </ion-col>\\n      <!-- <ion-col>\\n        <ion-input placeholder=\\\"Billing Price\\\">{{item.billingUnitPrice}}</ion-input>        \\n      </ion-col> -->\\n      <ion-col size=\\\"2\\\">\\n        <ion-input [(ngModel)]=\\\"item.quantity\\\"></ion-input>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n  </ion-item>  \\n </ion-list>\\n\\n<ion-grid>\\n    <ion-row>\\n      <ion-col size=\\\"6\\\">\\n        <ion-label color=\\\"primary\\\">Amount To Be Paid</ion-label>\\n      </ion-col>\\n      <ion-col size=\\\"6\\\">\\n        <ion-label >{{invoice.total}}</ion-label>\\n      </ion-col>\\n    </ion-row>  </ion-grid>\\n    <ion-grid>\\n      <ion-row>\\n        <ion-col>\\n          <ion-button color=\\\"primary\\\" (click)=\\\"calculateInvoiceTotal()\\\">Calculate Total</ion-button>\\n        </ion-col>\\n        \\n        <ion-col>\\n          <ion-button color=\\\"primary\\\" (click)=\\\"submitBill()\\\">Submit</ion-button>\\n        </ion-col>\\n        \\n        <ion-col>\\n          <ion-button color=\\\"primary\\\" (click)=\\\"printBill()\\\">Print</ion-button>\\n        </ion-col>\\n\\n      </ion-row>\\n    </ion-grid>\\n</ion-content>\\n\";"]}