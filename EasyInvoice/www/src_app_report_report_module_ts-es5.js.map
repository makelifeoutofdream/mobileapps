{"version":3,"sources":["webpack:///src/app/report/report-routing.module.ts","webpack:///src/app/report/report.module.ts","webpack:///src/app/report/report.page.ts","webpack:///src/app/report/report.page.scss","webpack:///src/app/report/report.page.html"],"names":["routes","path","component","ReportPage","ReportPageRoutingModule","NgModule","imports","RouterModule","exports","ReportPageModule","CommonModule","FormsModule","IonicModule","declarations","dbService","toastService","navCtrl","dataService","customerList","navigateForward","getAllInvoices","then","data","invoiceList","filterInvoices","reason","presentToast","console","log","getAllCustomers","startDate","endDate","start","Date","end","undefined","getFullYear","getMonth","getDate","selectedCustomer","filterInvoiceList","filter","inv","customer","id","invoiceDate","invoiceDataList","Array","invoiceItems","itm","invoiceData","InvoiceNumber","invoiceNumber","InvoiceDate","Customer","name","Item","UnitPrice","unitPrice","Quantity","quantity","Tax","tax","Total","total","push","exportToExcel","invoice","navigationExtras","queryParams","navigateRoot","DbService","ToastserviceService","NavController","DataService","Component","selector","template"],"mappings":"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","file":"src_app_report_report_module_ts-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ReportPage } from './report.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ReportPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ReportPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ReportPageRoutingModule } from './report-routing.module';\n\nimport { ReportPage } from './report.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ReportPageRoutingModule\n  ],\n  declarations: [ReportPage]\n})\nexport class ReportPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { NavigationExtras } from '@angular/router';\nimport { NavController } from '@ionic/angular';\nimport { stat } from 'fs';\nimport { start } from 'repl';\nimport { DataService } from '../data.service';\nimport { Customer } from '../services/customer';\nimport { DbService } from '../services/db.service';\nimport { Inventory } from '../services/inventory';\nimport { Invoice } from '../services/invoice';\nimport { ToastserviceService } from '../services/toastservice.service';\n\n@Component({\n  selector: 'app-report',\n  templateUrl: './report.page.html',\n  styleUrls: ['./report.page.scss'],\n})\nexport class ReportPage implements OnInit {\n  selectedCustomer : Customer;\n  startDate : Date;\n  endDate :Date;\n  invoiceList : Invoice [] ;\n  filterInvoiceList : Invoice [];\n  customerList : Customer [];\n  constructor(public dbService : DbService,public toastService : ToastserviceService,\n    public navCtrl:NavController,private dataService : DataService) { }\n\n  ngOnInit() {\n    this.customerList=[];\n  }\n\n  addNewInvoice(){\n    \n    this.navCtrl.navigateForward('newinvoice');\n  }\n\n  getAllInvoices(){\n    this.dbService.getAllInvoices().then(data=>{\n      this.invoiceList=data ;\n      this.filterInvoices();\n    }).catch(reason=>{\n      this.toastService.presentToast(\"Failed to fetch invoices\");\n      console.log(reason);\n    })\n  }\n  getAllCustomers(){\n    this.dbService.getAllCustomers().then(data=>this.customerList=data);\n  }\n  ionViewWillEnter(){\n    this.startDate=null;\n    this.endDate=null;\n    this.getAllInvoices();\n    this.getAllCustomers();\n    \n  }\n\n  \n  filterInvoices(){\n    var start=new Date(this.startDate);\n    var end=new Date(this.endDate);\n    if(this.startDate!=null && this.startDate!=undefined){\n      \n      start=new Date(start.getFullYear(),start.getMonth(),start.getDate());\n    }\n    if(this.endDate!=null && this.endDate!=undefined){\n      end=new Date(end.getFullYear(),end.getMonth(),end.getDate())\n    }\n    \n    \n    if(this.selectedCustomer!=null && this.selectedCustomer!=undefined && (this.startDate==null || this.startDate==undefined) && (this.endDate==null || this.endDate==undefined)){\n      this.filterInvoiceList= this.invoiceList.filter(inv=>inv.customer.id==this.selectedCustomer.id);\n    }else if(this.selectedCustomer!=null && this.selectedCustomer!=undefined && this.startDate!=null && this.startDate!=undefined && (this.endDate==null || this.endDate==undefined)){\n      this.filterInvoiceList= this.invoiceList.filter(inv=>inv.customer.id==this.selectedCustomer.id && new Date(inv.invoiceDate)>=start);\n    }else if(this.selectedCustomer!=null && this.selectedCustomer!=undefined && this.startDate!=null && this.startDate!=undefined &&  this.endDate!=null && this.endDate!=undefined){\n      this.filterInvoiceList= this.invoiceList.filter(inv=>inv.customer.id==this.selectedCustomer.id && new Date(inv.invoiceDate)>=start && new Date(inv.invoiceDate)<=end);\n    }else if((this.selectedCustomer==null || this.selectedCustomer==undefined) && this.startDate!=null && this.startDate!=undefined &&  this.endDate!=null && this.endDate!=undefined){\n      this.filterInvoiceList= this.invoiceList.filter(inv=> new Date(inv.invoiceDate)>=start && new Date(inv.invoiceDate)<=end);\n    }else if((this.selectedCustomer==null || this.selectedCustomer==undefined) && this.startDate!=null && this.startDate!=undefined &&  (this.endDate==null || this.endDate==undefined)){\n      this.filterInvoiceList= this.invoiceList.filter(inv=> new Date(inv.invoiceDate)>=start);\n    }else if((this.selectedCustomer==null || this.selectedCustomer==undefined) && (this.startDate==null || this.startDate==undefined) &&  this.endDate!=null && this.endDate!=undefined){\n      this.filterInvoiceList= this.invoiceList.filter(inv=> new Date(inv.invoiceDate)<=end );\n    }else{\n      this.filterInvoiceList=this.invoiceList;\n    }\n\n    \n  }\n\n  download(){\n    let invoiceDataList=new Array();\n    for(let inv of this.invoiceList){\n      for(let itm of inv.invoiceItems){\n        let invoiceData ={InvoiceNumber : inv.invoiceNumber,InvoiceDate:inv.invoiceDate,Customer:inv.customer.name,Item:itm.name,UnitPrice:itm.unitPrice,Quantity:itm.quantity,Tax:inv.tax,Total:inv.total};\n        invoiceDataList.push(invoiceData);\n      }\n      \n    } \n     // this.dataService.downloadCcSV(this.invoiceList,'invoices.csv');\n     this.dataService.exportToExcel(invoiceDataList,'invoices.xlsx');\n     \n    \n  }\n\n  viewInvoice(invoice : Invoice){\n    let navigationExtras : NavigationExtras ={\n      queryParams : {invoice : invoice}\n};\nconsole.log(\"selected invoice\"+invoice.invoiceNumber);\nthis.navCtrl.navigateRoot('viewinvoice',navigationExtras);    \n  }\n\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJyZXBvcnQucGFnZS5zY3NzIn0= */\";","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>Report</ion-title>\\n    <ion-buttons slot=\\\"start\\\">\\n        <ion-menu-button menu=\\\"mainmenu\\\"> \\n\\n        </ion-menu-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n<ion-content>\\n  <ion-row>\\n    <ion-col size=\\\"4\\\">\\n      <ion-item>\\n      <ion-select style=\\\"margin-top: 2%;height: 30px;margin-right: 4%;\\\"  [(ngModel)]=\\\"selectedCustomer\\\" placeholder=\\\"Customer\\\">\\n        <ion-select-option *ngFor=\\\"let cus of customerList\\\" [value]=\\\"cus\\\">{{cus.name}}</ion-select-option>\\n      </ion-select>\\n    </ion-item>\\n    </ion-col>\\n    <ion-col size=\\\"4\\\">\\n      <ion-item>\\n        <ion-datetime displayFormat=\\\"MMM DD YYYY\\\" [(ngModel)]=\\\"startDate\\\" placeholder=\\\"Start Date\\\"></ion-datetime>\\n      </ion-item>\\n    </ion-col>\\n\\n    <ion-col size=\\\"4\\\">\\n      <ion-item>\\n        <ion-datetime displayFormat=\\\"MMM DD YYYY\\\" [(ngModel)]=\\\"endDate\\\" placeholder=\\\"End Date\\\"></ion-datetime>\\n      </ion-item>\\n    </ion-col>\\n  </ion-row>\\n  <ion-row style=\\\"float:right\\\">\\n    <ion-button style=\\\"padding-right: 4px;\\\" (click)=\\\"filterInvoices()\\\">Search</ion-button>\\n  </ion-row>\\n  <ion-item-divider></ion-item-divider>\\n  \\n  <ion-list>\\n    <ion-row>\\n      <ion-col size=\\\"3\\\">Inv No</ion-col>\\n      <ion-col size=\\\"5\\\">Customer</ion-col>\\n      <ion-col size=\\\"4\\\">Total</ion-col>\\n    </ion-row>\\n    <ion-item *ngFor= \\\"let inv of filterInvoiceList\\\" (click)=\\\"viewInvoice(inv)\\\">\\n      \\n        \\n        \\n          <ion-col size=\\\"3\\\">{{inv.invoiceNumber}}</ion-col>\\n          <ion-col size=\\\"5\\\">{{inv.customer.name}}</ion-col>\\n          <ion-col size=\\\"4\\\">{{inv.total}}</ion-col>\\n       \\n     \\n    </ion-item>\\n  </ion-list>    \\n\\n</ion-content>\\n<ion-footer>\\n  \\n    \\n      <ion-row style=\\\"float:right\\\">\\n        <ion-col >\\n          <ion-button ion-button  color=\\\"primary\\\" (click)=\\\"download()\\\">\\n            <ion-icon name=\\\"mail\\\"></ion-icon>\\n          </ion-button>\\n        </ion-col>\\n      </ion-row>\\n        \\n    \\n  \\n  \\n</ion-footer>\";"]}